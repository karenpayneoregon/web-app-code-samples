@page
@model CheckedListBox.Pages.Index1Model
@{
}


<div class="container">

    <form method="post" id="main-content" asp-page-handler="resend" style="width: 25em;">

        <fieldset class="border rounded-3 border-primary p-1">

            <legend class="float-none w-auto fs-6 px-1"
                    id="description">
                <span class="fw-bold">Accessories</span>
            </legend>

            @for (var index = 0; index < Model.CheckModels.Count; index++)
            {
                <div class="row">
                    <div class="col-6 ms-3">

                        <!-- Hidden Id -->
                        <input asp-for="CheckModels[index].Id" type="hidden" />

                        <div class="form-check">

                            <!-- This is where your CheckboxAriaTagHelper will run -->
                            <input asp-for="CheckModels[index].Checked"
                                   type="checkbox"
                                   class="form-check-input js-aria-checkbox" />

                            <!-- Hidden Name to bind back on post -->
                            <input asp-for="CheckModels[index].Name" type="hidden" />

                            <label asp-for="CheckModels[index].Checked" class="form-check-label">
                                @Model.CheckModels[index].Name
                            </label>
                        </div>

                    </div>
                </div>
            }

            <div class="row mt-2 mb-2">
                <div class="ms-3">
                    <input id="resendToken"
                           type="submit"
                           class="btn btn-primary"
                           value="submit"
                           style="width: 130px;" />
                </div>
            </div>

        </fieldset>

    </form>

</div>

@section Scripts {
    <script>
        document.addEventListener("DOMContentLoaded", () => {

            document.querySelectorAll("input.js-aria-checkbox[type='checkbox']").forEach(function (cb) {

                    // Set initial aria-checked based on current checked state
                    cb.setAttribute("aria-checked", cb.checked ? "true" : "false");

                    // Update aria-checked whenever the checkbox changes
                    cb.addEventListener("change", function () {
                        this.setAttribute("aria-checked", this.checked ? "true" : "false");
                    });
                });

        });
    </script>
}
