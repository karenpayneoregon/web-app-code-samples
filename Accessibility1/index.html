<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Data entry sample</title>

    <link href="lib/bootstrap/dist/css/bootstrap.min.css" rel="stylesheet" />
    <script src="lib/jquery/dist/jquery.min.js"></script>
    <script src="lib/cleave.js"></script>
    <link rel="stylesheet" href="lib/css/WorkingForms1.css">
    <link href="lib/site.css" rel="stylesheet" />
</head>
<body>

    <div class="container" role="main" aria-label="Main">

        <form method="post" id="testForm" name="simpleForm" class="bg-light border p-3 position-absolute top-50 start-50 translate-middle shadow" style="width:25em;">

            <h1 class="fs-5 border-bottom">Data entry</h1>

            <div class="row">
                <div class="col-4">
                    <label for="firstName" class="form-label float-end">First name</label>
                </div>
                <div class="col-6">
                    <input type="text" class="form-control personName" id="firstName" name="firstName" aria-describedby="firstNameHelp" value=''>
                </div>
            </div>

            <div class="row mb-3">
                <div class="col-4"></div>
                <div class="col-6">
                    <div id="firstNameHelp" class="help">Enter your first name</div>
                </div>
            </div>

            <div class="row">
                <div class="col-4">
                    <label for="lastName" class="form-label float-end">Last name</label>
                </div>
                <div class="col-6">
                    <input type="text" class="form-control personName" id="lastName" name="lastName" aria-describedby="lastNameHelp" value=''>
                </div>
            </div>


            <div class="row mb-3">
                <div class="col-4"></div>
                <div class="col-6">
                    <div id="lastNameHelp" class="help">Enter your last name</div>
                </div>
            </div>

            <div class="row">
                <div class="col-4">
                    <label for="Salary" class="form-label float-end">Salary</label>
                </div>
                <div class="col-6">
                    <input class="input-numeral form-control salary" id="Salary" name="salary" aria-describedby="salaryHelp" value=0>
                </div>
            </div>

            <div class="row mb-3">
                <div class="col-4"></div>
                <div class="col-6">
                    <div id="salaryHelp" class="help">Enter your salary</div>
                </div>
            </div>

            <div class="row">
                <div class="col-4">
                    <label for="city" class="float-end">Select city</label>
                </div>
                <div class="col-6">
                    <select name="City" id="city" class="form-select city" aria-describedby="cityHelp">
                        <option value="Select">Select</option>
                        <option value="Portland">Portland</option>
                        <option value="Salem">Salem</option>
                        <option value="Eugene">Eugene</option>
                    </select>
                </div>
            </div>

            <div class="row mb-3">
                <div class="col-4"></div>
                <div class="col-6">
                    <div id="cityHelp" class="help">Select your city</div>
                </div>
            </div>
            
            <div class="row">
                <div class="col-4"><label for="f1" class="float-end">Select</label></div>
                <div class="col-6">
                    <fieldset id="f1" class="border border-info p-3 mb-3 department" aria-describedby="departmentHelp">
                        <legend class="float-none w-auto fs-6" id="departmentHelp">Department</legend>

                        <div class="form-check">
                            <input class="form-check-input" type="radio" name="departmentRadioGroup" id="training" aria-checked="false">
                            <label class="form-check-label" for="training">Training</label>
                        </div>

                        <div class="form-check">
                            <input class="form-check-input" type="radio" name="departmentRadioGroup" id="sales" aria-checked="false">
                            <label class="form-check-label" for="sales">Sales</label>
                        </div>

                        <div class="form-check">
                            <input class="form-check-input" type="radio" name="departmentRadioGroup" id="marketing" aria-checked="false">
                            <label class="form-check-label" for="marketing">Marketing</label>
                        </div>

                    </fieldset>
                </div>
            </div>






            <div class="form-check mb-3">
                <input class="form-check-input" type="checkbox" value="" id="contractor" name="contractor" aria-describedby="contractorHelp" aria-checked="True">
                <label class="form-check-label" for="contractor">   Contractor  </label>
                <div id="contractorHelp" class="help">Are you a contractor</div>
            </div>

            <input type="Reset" name="ResetForm" id="ResetForm" value="Clear Form" class="btn btn-secondary me-2">
            <input type="Submit" name="submitBack" value="Submit" class="btn btn-primary">

        </form>

    </div>
    <div class="footer fixed-bottom text-center">
        <div>Code sample</div>
    </div>
</body>

<script>
    /*
        - Sure this can be in a .js file
        - No intent on posting, just some simple asserts.
                For real we use proper validation
    */

    const form = document.querySelector('form')

    form.addEventListener('submit', (e) => {

        e.preventDefault();

        const formData = new FormData(form);

        for (const pair of formData.entries()) {
            if (pair[0] !== "departmentRadioGroup") {

                if (pair[0] === "salary") {
                    // only rigged for int at this time
                    console.log(`Salary ${parseFloat(pair[1].replaceAll(",", ""))}`)
                } else if (pair[0] === "City") {
                    if (pair[1] === "Select") {
                        console.log('No city')
                    } else {
                        console.log(pair);
                    }
                }
                else {
                    console.log(pair);
                }
            }
        }

        console.log(`Is contractor ${$("#contractor").is(":checked") ? 'Yes' : 'No'}`.replace(/ ' /g, " \\' "))

        const checked = form.querySelector('input[name=departmentRadioGroup]:checked');
        if (checked !== null) {
            console.log(`Department '${checked.id}'`.replace(/ ' /g, " \\' "));
        } else {
            console.log('Department not checked');
        }

        $('form').get(0).reset();

    });

    var cleaveNumeral = new Cleave('.input-numeral', {
        numeral: true,
        numeralThousandsGroupStyle: 'thousand'
    });


    document.getElementById("ResetForm").addEventListener("click", function () {
        $('form').get(0).reset();
    });

    document.addEventListener("DOMContentLoaded", () => {
        document.getElementById('city').value = 'Salem';
        document.getElementById("contractor").checked = true;
        document.getElementById("contractor").setAttribute('aria-checked', 'true');
        document.getElementById("sales").checked = true;
        document.getElementById("sales").setAttribute('aria-checked', 'true');
    });


    document.getElementById("training").addEventListener("click", function (currentIdentifier) {
        handleDepartmentRadioClick(currentIdentifier.target.id);
    });

    document.getElementById("sales").addEventListener("click", function (currentIdentifier) {
        handleDepartmentRadioClick(currentIdentifier.target.id);
    });

    document.getElementById("marketing").addEventListener("click", function (currentIdentifier) {
        handleDepartmentRadioClick(currentIdentifier.target.id);
    });

    document.getElementById("contractor").addEventListener("click", function () {

        if (document.getElementById("contractor").getAttribute('aria-checked') === 'true') {
            document.getElementById("contractor").setAttribute('aria-checked', 'false');
        } else {
            document.getElementById("contractor").setAttribute('aria-checked', 'true');
        }
    });

    /*
        set all radio buttons aria-checked to false followed by finding the current checked
        radio button and set it checked and set aria-checked to true
    */
    const deptRadioButtons = document.getElementsByName("departmentRadioGroup");
    function handleDepartmentRadioClick(currentIdentifier) {

        for (var index = 0; index < deptRadioButtons.length; index++) {
            document.getElementById(deptRadioButtons[index].id).setAttribute('aria-checked', 'false');
        }

        for (let index = 0, groups = deptRadioButtons.length; index < groups; index++) {
            if (deptRadioButtons[index].id === currentIdentifier) {
                document.getElementById(currentIdentifier).setAttribute('aria-checked', 'true');
                document.getElementById(currentIdentifier).setAttribute('checked', 'true');
            }
        }
    }



</script>
</html>
